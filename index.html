<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="assets/favicon.png">
    <title>Grid.Design</title>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    </head>
<body>
<div class="slideshow-container">
  <div class="slides-inner" id="slideRow">
    <div class="mySlides"><img src="assets/productImages/Charge/charge-blue-2.png"></div>
    
    <div class="mySlides"><img src="assets/productImages/Charge/charge-orange-1.png"></div>
    <div class="mySlides"><img src="assets/productImages/Charge/charge-orange-2.png"></div>
    <div class="mySlides"><img src="assets/productImages/Charge/charge-yellow-1.png"></div>
    <div class="mySlides"><img src="assets/productImages/Charge/charge-yellow-2.png"></div>
    <div class="mySlides"><img src="assets/productImages/Charge/charge-blue-1.png"></div>
    <div class="mySlides"><img src="assets/productImages/Charge/charge-blue-2.png"></div>

    <div class="mySlides"><img src="assets/productImages/Charge/charge-orange-1.png"></div>
  </div>
</div>

    <div class="header">
        <img src="assets/Grid.svg" class="icon">
        <div class="icons">
            <img src="assets/shopping_cart.svg" class="icon">
            <img src="assets/apps.svg" class="icon" id="menu-toggle">
        </div>
    </div>

    <div class="modalbg headermenu">
        <div class="modal2">
            <div>
                <p class="rounded">Projects</p>
                <p>Charge</p>
            </div>
            <div>
                <p class="rounded">Company</p>
                <p>About</p>
                <p>Terms</p>
                <p>Privacy</p>
                <p>Returns</p>
            </div>
        </div>
    </div>

    <div class="info">
        <div>
            <h1>Grid Charge 1</h1>
            <p>Beautifully functional. Functionally beautiful.</p>
        </div>
        <div class="colors">
            <div class="color orange active-color" onclick="currentSlide(1)"></div>
            <div class="color yellow" onclick="currentSlide(3)"></div>
            <div class="color blue" onclick="currentSlide(5)"></div>
        </div>
        
        <button class="btn active-btn" id="main-cart-btn">
            <span class="rounded">Add to Cart</span><span>â‚¬35</span>
        </button>

        <div style="text-align:center" class="dots">
            <span class="dot" onclick="currentSlide(1)"></span>
            <span class="dot" onclick="currentSlide(2)"></span>
            <span class="dot" onclick="currentSlide(3)"></span>
            <span class="dot" onclick="currentSlide(4)"></span>
            <span class="dot" onclick="currentSlide(5)"></span>
            <span class="dot" onclick="currentSlide(6)"></span>
        </div>
    </div>
</body>

<script>
let slideIndex = 1; 
const slideRow = document.getElementById('slideRow');
const dots = document.getElementsByClassName("dot");
const slides = document.querySelectorAll('.mySlides');
const totalOriginalSlides = slides.length - 2; 

function showSlides(n, animated = true) {
    if (animated) {
        slideRow.style.transition = 'transform 0.5s cubic-bezier(0.25, 1, 0.5, 1)';
    } else {
        slideRow.style.transition = 'none';
    }
    const percent = n * -100;
    slideRow.style.transform = `translateX(${percent}vw)`;
    updateDots(n);
}

function updateDots(n) {
    let displayIndex = n;
    if (n > totalOriginalSlides) displayIndex = 1;
    if (n < 1) displayIndex = totalOriginalSlides;

    for (let i = 0; i < dots.length; i++) {
        dots[i].className = dots[i].className.replace(" active", "");
    }
    if (dots[displayIndex - 1]) {
        dots[displayIndex - 1].className += " active";
    }
}

// THE KEY UPDATE: Handling clicks specifically
function currentSlide(n) {
    slideIndex = n;
    showSlides(slideIndex);

    // Get the element that was actually clicked
    const clickedElement = window.event ? window.event.target : null;

    // Only update the color indicator if the user clicked a "color" div
    // This ignores clicks coming from "dot" spans or swipe actions
    if (clickedElement && clickedElement.classList.contains('color')) {
        const colorDivs = document.querySelectorAll('.color');
        colorDivs.forEach(div => div.classList.remove('active-color'));
        clickedElement.classList.add('active-color');
    }
}

// Infinite loop logic
slideRow.addEventListener('transitionend', () => {
    if (slideIndex > totalOriginalSlides) {
        slideIndex = 1;
        showSlides(slideIndex, false);
    }
    if (slideIndex < 1) {
        slideIndex = totalOriginalSlides;
        showSlides(slideIndex, false);
    }
});

// Navigation helpers
function plusSlides(n) { 
    slideIndex += n;
    showSlides(slideIndex); 
}

// Swipe Logic
let startX = 0;
let isDragging = false;
const dragStart = (e) => {
    isDragging = true;
    startX = e.type.includes('touch') ? e.touches[0].clientX : e.clientX;
};
const dragEnd = (e) => {
    if (!isDragging) return;
    let endX = e.type.includes('touch') ? e.changedTouches[0].clientX : e.clientX;
    const threshold = 50;
    if (endX < startX - threshold) plusSlides(1);
    else if (endX > startX + threshold) plusSlides(-1);
    else showSlides(slideIndex);
    isDragging = false;
};

const container = document.querySelector('.slideshow-container');
container.addEventListener('mousedown', dragStart);
window.addEventListener('mouseup', dragEnd);
container.addEventListener('touchstart', dragStart, {passive: true});
container.addEventListener('touchend', dragEnd);
container.addEventListener('dragstart', (e) => e.preventDefault());

showSlides(slideIndex, false);

// Menu logic
const menuToggle = document.getElementById('menu-toggle');
const headerMenu = document.querySelector('.headermenu');
const header = document.querySelector('.header');
function closeMenu() {
    headerMenu.classList.remove('headermenuactive');
    header.classList.remove('menu-open');
}
menuToggle.addEventListener('click', () => {
    headerMenu.classList.toggle('headermenuactive');
    header.classList.toggle('menu-open');
});
headerMenu.addEventListener('click', (e) => { if (e.target === headerMenu) closeMenu(); });
</script>
</html>